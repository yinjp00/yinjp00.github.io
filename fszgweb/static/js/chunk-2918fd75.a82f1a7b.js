/*!
 *  build: vue-admin-beautiful 
 *  vue-admin-beautiful author: chuzhixin 1204505056@qq.com 
 *  vue-admin-beautiful QQ Group(QQ群): 972435319、1139183756 
 *  time: 2022-1-21 16:12:28
 */
(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2918fd75"],{"04af":function(e,t,a){},"0ab4":function(e,t,a){"use strict";a("04af")},"236a":function(e,t,a){"use strict";a.r(t),a.d(t,"getTemplateList",(function(){return o})),a.d(t,"getTemplateId",(function(){return l})),a.d(t,"saveOrUpdate",(function(){return n})),a.d(t,"doDelete",(function(){return i})),a.d(t,"saveOrUpdateItem",(function(){return s})),a.d(t,"deleteItem",(function(){return u})),a.d(t,"auditStatus",(function(){return c})),a.d(t,"auditStatusReject",(function(){return m})),a.d(t,"getCheckList",(function(){return d})),a.d(t,"getCheckCategoryList",(function(){return p}));var r=a("b775");function o(e){return Object(r["default"])({url:"/api/yxdpc/template/getList",method:"post",data:e})}function l(e){return Object(r["default"])({url:"/api/yxdpc/template/getId",method:"post",data:e})}function n(e){return Object(r["default"])({url:"/api/yxdpc/template/saveOrUpdate",method:"post",data:e})}function i(e){return Object(r["default"])({url:"/api/yxdpc/template/delete",method:"post",data:e})}function s(e){return Object(r["default"])({url:"/api/yxdpc/template/saveOrUpdateItem",method:"post",data:e})}function u(e){return Object(r["default"])({url:"/api/yxdpc/template/deleteItem",method:"post",data:e})}function c(e){return Object(r["default"])({url:"/api/yxdpc/template/auditStatus",method:"post",data:e})}function m(e){return Object(r["default"])({url:"/api/yxdpc/template/auditStatusReject",method:"post",data:e})}function d(e){return Object(r["default"])({url:"/api/yxdpc/check/getList",method:"post",data:e})}function p(e){return Object(r["default"])({url:"/api/yxdpc/checkCatogory/getList",method:"post",data:e})}},"271e":function(e,t,a){"use strict";a("c77e")},"3e3d":function(e,t,a){},8932:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"check-container"},[a("el-dialog",{attrs:{title:"巡检列表",visible:e.dialogFormVisible,width:"70%",top:"15vh"},on:{"update:visible":function(t){e.dialogFormVisible=t},close:e.close}},[a("vab-query-form",[a("el-form",{ref:"form",attrs:{inline:!0,model:e.queryForm},nativeOn:{submit:function(e){e.preventDefault()}}},[a("el-form-item",{attrs:{label:"巡检内容："}},[a("el-input",{attrs:{placeholder:"请输入巡检内容",clearable:""},model:{value:e.queryForm.checkContent,callback:function(t){e.$set(e.queryForm,"checkContent","string"===typeof t?t.trim():t)},expression:"queryForm.checkContent"}})],1),a("el-form-item",[a("el-button",{attrs:{icon:"el-icon-search",type:"primary"},on:{click:e.queryData}},[e._v(" 查询 ")])],1)],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],attrs:{data:e.list,"element-loading-text":e.elementLoadingText,"header-cell-style":{background:"#EFF3F8"},"highlight-current-row":""},on:{"current-change":e.handleCurTr}},[a("el-table-column",{attrs:{type:"index",width:"50"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"checkContent",label:"巡检内容"}})],1),a("el-pagination",{attrs:{background:"","current-page":e.queryForm.pageIndex,"page-size":e.queryForm.pageSize,layout:e.layout,total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1)},o=[],l=a("1da1"),n=(a("96cf"),a("a9e3"),a("236a")),i={name:"Checks",components:{},data:function(){return{queryForm:{pageIndex:1,pageSize:10,checkContent:""},list:[],listLoading:!0,elementLoadingText:"正在加载...",layout:"total, sizes, prev, pager, next, jumper",total:0,dialogFormVisible:!1}},created:function(){},mounted:function(){this.fetchData()},methods:{showEdit:function(){this.dialogFormVisible=!0},close:function(){this.$refs["form"].resetFields(),this.form=this.$options.data().form,this.dialogFormVisible=!1},handleSizeChange:function(e){this.queryForm.pageSize=e,this.fetchData()},handleCurrentChange:function(e){this.queryForm.pageIndex=e,this.fetchData()},handleCurTr:function(e){this.dialogFormVisible=!1,this.$emit("checksInfo",e)},queryData:function(){this.queryForm.pageIndex=1,this.fetchData()},fetchData:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){var a,r,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.listLoading=!0,t.next=3,Object(n["getCheckList"])(e.queryForm);case 3:a=t.sent,r=a.code,o=a.data,200==r&&(e.list=o.result,e.total=Number(o.totalRecords||o.result.length),e.listLoading=!1);case 7:case"end":return t.stop()}}),t)})))()}}},s=i,u=(a("0ab4"),a("2877")),c=Object(u["a"])(s,r,o,!1,null,"be9d7034",null);t["default"]=c.exports},"9f23":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"check-container"},[a("vab-query-form",[a("el-form",{attrs:{inline:!0,model:e.queryForm},nativeOn:{submit:function(e){e.preventDefault()}}},[a("vab-query-form-left-panel",{attrs:{span:18}},[a("el-form-item",[e._v(" 模版名称： "),a("el-input",{attrs:{placeholder:"请输入模版名称",clearable:""},model:{value:e.queryForm.templateName,callback:function(t){e.$set(e.queryForm,"templateName","string"===typeof t?t.trim():t)},expression:"queryForm.templateName"}})],1),a("el-form-item",[e._v(" 模版类型： "),a("el-select",{attrs:{clearable:"",placeholder:"请选择"},model:{value:e.queryForm.templateType,callback:function(t){e.$set(e.queryForm,"templateType",t)},expression:"queryForm.templateType"}},e._l(e.templateTypeArr,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),a("el-form-item",[e._v(" 状态： "),a("el-select",{attrs:{clearable:"",placeholder:"请选择"},model:{value:e.queryForm.status,callback:function(t){e.$set(e.queryForm,"status",t)},expression:"queryForm.status"}},e._l(e.statusArr,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),a("vab-query-form-right-panel",{attrs:{span:6}},[a("el-form-item",[a("el-button",{attrs:{icon:"el-icon-search",type:"primary"},on:{click:e.queryData}},[e._v(" 查询 ")])],1)],1)],1)],1),a("el-row",{staticClass:"marginbtm"},[a("el-button",{attrs:{icon:"el-icon-plus",type:"primary"},on:{click:e.handleEdit}},[e._v(" 新增 ")])],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],attrs:{data:e.list,"element-loading-text":e.elementLoadingText,"header-cell-style":{background:"#EFF3F8"}},on:{"selection-change":e.setSelectRows}},[a("el-table-column",{attrs:{"show-overflow-tooltip":"",type:"selection"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"templateName",label:"模版名称"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":"",label:"模版类型"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(" "+e._s(e.templateTypeObj[a.templateType])+" ")]}}])}),a("el-table-column",{attrs:{"show-overflow-tooltip":"",label:"得分类型"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(" "+e._s(e.scoreTypeObj[a.scoreType])+" ")]}}])}),a("el-table-column",{attrs:{"show-overflow-tooltip":"",label:"评分规则"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(" "+e._s(e.scoreRuleObj[a.scoreRule])+" ")]}}])}),a("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"templateRule",label:"合格分数"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"templateDescribe",label:"模板描述"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":"",label:"审核状态"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[2==r.auditStatus?a("el-tooltip",{attrs:{placement:"top"}},[a("div",{attrs:{slot:"content"},slot:"content"},[e._v("拒绝原因："+e._s(r.rejectReason))]),a("el-tag",{attrs:{type:"warning"}},[e._v(" "+e._s(e.auditStatusObj[r.auditStatus])+" "),a("i",{staticClass:"el-icon-warning"})])],1):a("el-tag",[e._v(e._s(e.auditStatusObj[r.auditStatus]))])]}}])}),a("el-table-column",{attrs:{"show-overflow-tooltip":"",label:"操作",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handleEdit(r)}}},[e._v("编辑")]),a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handleDelete(r)}}},[e._v("删除")]),0==r.auditStatus?a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handlePass(r)}}},[e._v(" 审核 ")]):e._e(),0==r.auditStatus?a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handleRefuse(r)}}},[e._v(" 拒绝 ")]):e._e()]}}])})],1),a("el-pagination",{attrs:{background:"","current-page":e.queryForm.pageIndex,"page-size":e.queryForm.pageSize,layout:e.layout,total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}),a("edit",{ref:"edit",on:{"fetch-data":e.fetchData}}),a("el-dialog",{attrs:{title:"拒绝原因",visible:e.dialogRefuseVisible,width:"500px",top:"30vh"},on:{"update:visible":function(t){e.dialogRefuseVisible=t},close:e.closeRefuse}},[a("div",{staticClass:"dialogCus"},[a("el-form",{ref:"formRefuse",attrs:{model:e.formRefuse,rules:e.rules,"label-width":"110px"}},[a("el-form-item",{attrs:{label:"拒绝原因:",prop:"rejectReason"}},[a("el-input",{attrs:{type:"textarea",rows:5,autocomplete:"off"},model:{value:e.formRefuse.rejectReason,callback:function(t){e.$set(e.formRefuse,"rejectReason",t)},expression:"formRefuse.rejectReason"}})],1)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.closeRefuse}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.saveRefuse}},[e._v("确 定")])],1)])],1)},o=[],l=a("1da1"),n=(a("a15b"),a("d81d"),a("a9e3"),a("96cf"),a("236a")),i=a("ff13"),s={name:"CheckModel",components:{Edit:i["default"]},data:function(){return{templateTypeArr:[{value:"1",label:"门店巡检"},{value:"2",label:"常规巡检"},{value:"3",label:"专项巡检"},{value:"4",label:"飞行巡检（预留）"}],statusArr:[{value:"1",label:"可用"},{value:"2",label:"不可用"}],list:[],listLoading:!0,elementLoadingText:"正在加载...",layout:"total, sizes, prev, pager, next, jumper",total:0,selectRows:"",queryForm:{pageIndex:1,pageSize:10,templateName:"",templateType:"",status:""},dialogRefuseVisible:!1,formRefuse:{uuid:"",rejectReason:""},rules:{rejectReason:[{required:!0,trigger:"blur",message:"请输入拒绝理由"}]},templateTypeObj:{1:"门店巡检",2:"常规巡检",3:"专项巡检",4:"飞行巡检（预留）"},scoreRuleObj:{1:"手动评分",2:"系统评分"},scoreTypeObj:{1:"按照实际得分",2:"换算成百分制"},auditStatusObj:{0:"已保存",1:"通过",2:"驳回"}}},created:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.fetchData();case 1:case"end":return t.stop()}}),t)})))()},methods:{setSelectRows:function(e){this.selectRows=e},handleEdit:function(e){e.pid?this.$refs["edit"].showEdit(e):this.$refs["edit"].showEdit()},handleDelete:function(e){var t=this;if(e.pid)this.$baseConfirm("确定删除该条信息吗？",null,Object(l["a"])(regeneratorRuntime.mark((function a(){var r,o,l;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,Object(n["doDelete"])({uuid:e.pid});case 2:r=a.sent,o=r.message,l=r.code,200===l&&(t.$baseMessage(o||"删除成功！","success"),t.fetchData());case 6:case"end":return a.stop()}}),a)}))));else{if(!(this.selectRows.length>0))return this.$baseMessage("未选中任何行","error"),!1;var a=this.selectRows.map((function(e){return e.pid})).join();this.$baseConfirm("你确定要删除选中项吗？",null,Object(l["a"])(regeneratorRuntime.mark((function e(){var r,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(n["doDelete"])({ids:a});case 2:r=e.sent,o=r.msg,t.$baseMessage(o||"删除成功！","success"),t.fetchData();case 6:case"end":return e.stop()}}),e)}))))}},handlePass:function(e){var t=this;e.pid&&this.$baseConfirm("确定通过该条审核吗？",null,Object(l["a"])(regeneratorRuntime.mark((function a(){var r,o,l;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,Object(n["auditStatus"])({uuid:e.pid});case 2:r=a.sent,o=r.message,l=r.code,200===l&&(t.$baseMessage(o||"审核成功！","success"),t.fetchData());case 6:case"end":return a.stop()}}),a)}))))},handleRefuse:function(e){e.pid&&(this.dialogRefuseVisible=!0,this.formRefuse.uuid=e.pid)},saveRefuse:function(){var e=this;this.$refs["formRefuse"].validate(function(){var t=Object(l["a"])(regeneratorRuntime.mark((function t(a){var r,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!a){t.next=9;break}return t.next=3,Object(n["auditStatusReject"])(e.formRefuse);case 3:r=t.sent,r.message,o=r.code,200===o&&(e.fetchData(),e.closeRefuse()),t.next=10;break;case 9:return t.abrupt("return",!1);case 10:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},closeRefuse:function(){this.$refs["formRefuse"].resetFields(),this.form=this.$options.data().form,this.dialogRefuseVisible=!1},handleSizeChange:function(e){this.queryForm.pageSize=e,this.fetchData()},handleCurrentChange:function(e){this.queryForm.pageIndex=e,this.fetchData()},queryData:function(){this.queryForm.pageIndex=1,this.fetchData()},fetchData:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){var a,r,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.listLoading=!0,t.next=3,Object(n["getTemplateList"])(e.queryForm);case 3:a=t.sent,r=a.code,o=a.data,200==r&&(e.list=o.result,e.total=Number(o.totalRecords),e.listLoading=!1);case 7:case"end":return t.stop()}}),t)})))()}}},u=s,c=(a("a59f"),a("2877")),m=Object(c["a"])(u,r,o,!1,null,"cbecf3ce",null);t["default"]=m.exports},a59f:function(e,t,a){"use strict";a("3e3d")},c77e:function(e,t,a){e.exports={"menu-color":"rgba(255,255,255,.95)","menu-color-active":"rgba(255,255,255,.95)","menu-background":"#282c34"}},ff13:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-dialog",{attrs:{title:e.title,visible:e.dialogFormVisible,width:"70%",top:"15vh"},on:{"update:visible":function(t){e.dialogFormVisible=t},close:e.close}},[a("div",{staticClass:"dialogCus"},[a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"120px"}},[a("el-form-item",{attrs:{label:"名称:",prop:"templateName"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.templateName,callback:function(t){e.$set(e.form,"templateName",t)},expression:"form.templateName"}})],1),a("el-form-item",{attrs:{label:"巡检类型:",prop:"templateType"}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择"},model:{value:e.form.templateType,callback:function(t){e.$set(e.form,"templateType",t)},expression:"form.templateType"}},e._l(e.templateTypeArr,(function(e){return a("el-option",{key:e.templateType,attrs:{label:e.label,value:e.value}})})),1)],1),a("el-form-item",{attrs:{label:"得分类型:",prop:"scoreType"}},[a("el-radio-group",{model:{value:e.form.scoreType,callback:function(t){e.$set(e.form,"scoreType",t)},expression:"form.scoreType"}},[a("el-radio",{attrs:{label:"1"}},[e._v("按照实际得分")]),a("el-radio",{attrs:{label:"2"}},[e._v("换算成百分制")])],1)],1),a("el-form-item",{attrs:{label:"评分规则:",prop:"scoreRule"}},[a("el-radio-group",{model:{value:e.form.scoreRule,callback:function(t){e.$set(e.form,"scoreRule",t)},expression:"form.scoreRule"}},[a("el-radio",{attrs:{label:"1"}},[e._v("手动评分")]),a("el-radio",{attrs:{label:"2"}},[e._v("系统评分")])],1)],1),a("el-form-item",{attrs:{label:"合格分数:",prop:"templateRule"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.templateRule,callback:function(t){e.$set(e.form,"templateRule",t)},expression:"form.templateRule"}})],1),a("el-form-item",{attrs:{label:"模版描述:",prop:"templateDescribe"}},[a("el-input",{attrs:{type:"textarea",rows:4,autocomplete:"off"},model:{value:e.form.templateDescribe,callback:function(t){e.$set(e.form,"templateDescribe",t)},expression:"form.templateDescribe"}})],1)],1),e.isDetModel?a("div",{staticClass:"tempItemHeader"},[e._v(" 当前模板共有："+e._s(e.form.itemList&&e.form.itemList.length)+"项 红线项："+e._s(e.checkAttribute4Count)+"项 否决项："+e._s(e.checkAttribute5Count)+"项 扣款项："+e._s(e.isDeductionCount)+"项 总分："+e._s(e.totalRule)+" 扣分项："+e._s(e.checkAttribute3Count)+"项（-0） 加分项："+e._s(e.checkAttribute2Count)+"项（+0） ")]):e._e(),e.isDetModel?a("div",{staticClass:"tempItemHeader mtop20"},[a("el-button",{staticStyle:{"margin-bottom":"20px"},on:{click:e.addziduan}},[e._v(" 添加模板明细 ")]),a("el-table",{staticClass:"kong-box",attrs:{data:e.form.itemList,"header-cell-style":{background:"#EFF3F8"}}},[a("el-table-column",{attrs:{type:"index",label:"序号"}}),a("el-table-column",{attrs:{prop:"columnName1",label:"巡检内容"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-input",{attrs:{readonly:""},nativeOn:{click:function(t){return e.checkContentClick(r)}},model:{value:r.columnName1,callback:function(t){e.$set(r,"columnName1",t)},expression:"row.columnName1"}})]}}],null,!1,1088715790)}),a("el-table-column",{attrs:{prop:"templateName",label:"分类"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-select",{attrs:{disabled:"",placeholder:"请选择"},model:{value:r.checkCatogoryId,callback:function(t){e.$set(r,"checkCatogoryId",t)},expression:"row.checkCatogoryId"}},e._l(e.catogorys,(function(e){return a("el-option",{key:e.pid,attrs:{label:e.catogoryName,value:e.pid}})})),1)]}}],null,!1,4059155883)}),a("el-table-column",{attrs:{prop:"checkAttribute",label:"属性"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-select",{attrs:{disabled:"",placeholder:"请选择"},model:{value:r.checkAttribute,callback:function(t){e.$set(r,"checkAttribute",t)},expression:"row.checkAttribute"}},e._l(e.checkAttributeArr,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)]}}],null,!1,3607655881)}),a("el-table-column",{attrs:{prop:"itemPartition",label:"内容分区"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-input",{on:{change:e.itemPartitionBlur},model:{value:r.itemPartition,callback:function(t){e.$set(r,"itemPartition",t)},expression:"row.itemPartition"}})]}}],null,!1,2281864399)}),a("el-table-column",{attrs:{prop:"itemRule",label:"项分数"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-input",{on:{change:e.itemRuleBlur},model:{value:r.itemRule,callback:function(t){e.$set(r,"itemRule",t)},expression:"row.itemRule"}})]}}],null,!1,2279030703)}),a("el-table-column",{attrs:{"show-overflow-tooltip":"",label:"操作",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.deleteit(r)}}},[e._v("删除")]),a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.sureEdit(r)}}},[e._v(" 确认修改 ")])]}}],null,!1,981767458)})],1)],1):e._e()],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.close}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.save}},[e._v("确 定")])],1)]),a("checks",{ref:"checks",on:{checksInfo:e.getChecksInfo}})],1)},o=[],l=a("1da1"),n=(a("a434"),a("159b"),a("96cf"),a("236a")),i=a("8932"),s=a("d188"),u={name:"Edit",components:{ElButton:s["a"],Checks:i["default"]},data:function(){return{form:{uuid:"",templateCode:"",templateName:"",templateType:"",scoreType:"",scoreRule:"",templateRule:"",templateDescribe:"",status:"",auditStatus:"",rejectReason:"",itemList:[]},totalRule:0,isDeductionCount:0,checkAttribute2Count:0,checkAttribute3Count:0,checkAttribute4Count:0,checkAttribute5Count:0,rules:{templateName:[{required:!0,trigger:"blur",message:"请输入模版名称"}],templateType:[{required:!0,trigger:"blur",message:"请选择模版类型"}],scoreType:[{required:!0,trigger:"blur",message:"请选择得分类型"}]},templateTypeArr:[{value:"1",label:"门店巡检"},{value:"2",label:"常规巡检"},{value:"3",label:"专项巡检"},{value:"4",label:"飞行巡检（预留）"}],checkAttributeArr:[{value:"1",label:"一般项此项参与总分合计"},{value:"2",label:"加分项此项不参与总分为额外加分项"},{value:"3",label:"扣分项此项不参与总分为额外减分项"},{value:"4",label:"红线项此项不合格将导致该项巡检分类得0分"},{value:"5",label:"否决项此项不合格将导致整份报告得0分"}],title:"",isDetModel:!1,dialogFormVisible:!1,curIndex:0,catogorys:[],curRowData:{}}},computed:{},created:function(){this.getCheckCategoryList()},methods:{getCheckCategoryList:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){var a,r,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(n["getCheckCategoryList"])({status:1});case 2:a=t.sent,r=a.code,o=a.data,200==r&&(e.catogorys=o);case 6:case"end":return t.stop()}}),t)})))()},checkContentClick:function(e){this.curIndex=e.orderNum,this.$refs["checks"].showEdit();var t=this;e.pid&&(t.curRowData.uuid=e.pid),t.curRowData.templateId=this.form.pid,t.curRowData.itemPartition=e.itemPartition,t.curRowData.itemRule=e.itemRule,t.curRowData.orderNum=e.orderNum},getChecksInfo:function(e){console.log(e);var t=this,a=t.form.itemList;e&&(a[t.curIndex-1].columnName1=e.checkContent,a[t.curIndex-1].checkAttribute=e.checkAttribute,a[t.curIndex-1].checkCatogoryId=e.checkCatogoryId,t.curRowData.checkAttribute=e.checkAttribute,t.curRowData.checkCatogoryId=e.checkCatogoryId,t.curRowData.checkId=e.pid,t.curRowData.isDeduction=e.isDeduction)},addziduan:function(){this.form.itemList.push({templateId:this.form.pid,checkId:"",checkAttribute:"",checkCatogoryId:"",isDeduction:"",itemPartition:"",itemRule:"",orderNum:this.form.itemList&&this.form.itemList.length+1})},itemPartitionBlur:function(e){this.curRowData.itemPartition=e},itemRuleBlur:function(e){this.curRowData.itemRule=e},deleteit:function(e){this.form.itemList.splice(e.orderNum-1,1),this.form.itemList.forEach((function(e,t){e.orderNum=t+1}))},sureEdit:function(e){var t=this.curRowData,a=t.templateId,r=t.checkId,o=t.itemPartition,l=t.itemRule;a?r?o?l?this.saveOrUpdateItem(this.curRowData):this.$baseMessage("请输入分数","error"):this.$baseMessage("请输入内容分区","error"):this.$baseMessage("请选择巡检模板","error"):this.$baseMessage("请先添加并保存主模板后再编辑！","error")},showEdit:function(e){var t=this;return Object(l["a"])(regeneratorRuntime.mark((function a(){var r,o,l;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(r=t,e){a.next=6;break}t.title="添加",t.isDetModel=!1,a.next=14;break;case 6:return t.isDetModel=!0,t.title="编辑",a.next=10,Object(n["getTemplateId"])({uuid:e.pid});case 10:o=a.sent,l=o.data,l.itemList&&l.itemList.length>0?l.itemList.forEach((function(e){e.checkContent="",r.totalRule+=e.itemRule,1==e.isDeduction&&r.isDeductionCount++,1!=e.checkAttribute&&r["checkAttribute"+e.checkAttribute+"Count"]++})):l.itemList=[],t.form=Object.assign({},l);case 14:t.dialogFormVisible=!0;case 15:case"end":return a.stop()}}),a)})))()},close:function(){this.$refs["form"].resetFields(),this.form=this.$options.data().form,this.dialogFormVisible=!1},saveOrUpdateItem:function(e){var t=this;return Object(l["a"])(regeneratorRuntime.mark((function a(){var r,o,l;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,Object(n["saveOrUpdateItem"])(e);case 2:r=a.sent,o=r.message,l=r.code,200===l&&t.$baseMessage(o||"修改成功！","success");case 6:case"end":return a.stop()}}),a)})))()},save:function(){var e=this;this.$refs["form"].validate(function(){var t=Object(l["a"])(regeneratorRuntime.mark((function t(a){var r,o,l,i,s,u,c,m,d,p,f,h,b;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!a){t.next=19;break}return r={},o=e.form,l=o.pid,o.templateCode,i=o.templateName,s=o.templateType,u=o.scoreType,c=o.scoreRule,m=o.templateRule,d=o.templateDescribe,p=o.status,f=o.auditStatus,l&&(r.uuid=l,f&&2==f&&(r.auditStatus="0")),r.templateName=i,r.templateType=s,r.scoreType=u,r.scoreRule=c,r.templateRule=m,r.templateDescribe=d,r.status=p,t.next=13,Object(n["saveOrUpdate"])(r);case 13:h=t.sent,h.message,b=h.code,200===b&&(e.$emit("fetch-data"),e.close()),t.next=20;break;case 19:return t.abrupt("return",!1);case 20:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}}},c=u,m=(a("271e"),a("2877")),d=Object(m["a"])(c,r,o,!1,null,null,null);t["default"]=d.exports}}]);